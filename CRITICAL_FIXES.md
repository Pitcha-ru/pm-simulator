# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Ñ–∏–Ω–∞–ª—å–Ω—ã–µ)

## üî¥ –ü–†–û–ë–õ–ï–ú–ê 1: –ö–∞—Ä—Ç–æ—á–∫–∞ —Å–º–µ—â–∞–µ—Ç—Å—è –ø—Ä–∏ drag

**–°–∏–º–ø—Ç–æ–º**: –ü—Ä–∏ –Ω–∞—á–∞–ª–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∞ –º–µ–Ω—è–µ—Ç –ø–æ–ª–æ–∂–µ–Ω–∏–µ

**–ü—Ä–∏—á–∏–Ω–∞**: –í `dragDrop.js` –º—ã –º–µ–Ω—è–ª–∏ `cursor` –Ω–∞ `grabbing`, —á—Ç–æ –º–æ–≥–ª–æ –≤—ã–∑—ã–≤–∞—Ç—å reflow

**–†–µ—à–µ–Ω–∏–µ**:
```javascript
// –£–ë–†–ê–õ–ò –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—Ä–æ–º–µ opacity
startDrag(x, y) {
    // –¢–û–õ–¨–ö–û opacity
    this.originalCard.style.opacity = '0.3';
    // –ù–ï–¢ cursor, –ù–ï–¢ transform, –ù–ï–¢ position
}

endDrag(x, y) {
    // –¢–æ–ª—å–∫–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º opacity
    this.originalCard.style.opacity = '1';
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ö–∞—Ä—Ç–æ—á–∫–∞ **–ê–ë–°–û–õ–Æ–¢–ù–û** —Å—Ç–∞–±–∏–ª—å–Ω–∞

---

## üî¥ –ü–†–û–ë–õ–ï–ú–ê 2: –í—Å–µ –∂–∏–∑–Ω–∏ —Å–≥–æ—Ä–∞—é—Ç —Å—Ä–∞–∑—É

**–°–∏–º–ø—Ç–æ–º**: –ü—Ä–∏ timeout –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞—Ä—Ç–æ—á–µ–∫ —Ç–µ—Ä—è—é—Ç—Å—è –≤—Å–µ 3 –∂–∏–∑–Ω–∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ

**–ü—Ä–∏—á–∏–Ω–∞**: –§—É–Ω–∫—Ü–∏—è `checkTimeouts()` –≤—ã–∑—ã–≤–∞–µ—Ç `onTaskTimeout()` –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ –≤ –æ–¥–Ω–æ–º —Ü–∏–∫–ª–µ. –ö–∞—Ä—Ç–æ—á–∫–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ UI —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ 500ms, –Ω–æ **–æ—Å—Ç–∞–µ—Ç—Å—è –≤ `gameState.activeTasks`**, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–µ (—á–µ—Ä–µ–∑ 50ms) –æ–Ω–∞ —Å–Ω–æ–≤–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è!

**–î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**:
```javascript
// –¶–∏–∫–ª 1 (t=0ms):
checkTimeouts() {
    timedOutTasks = [task1, task2, task3]  // –í—Å–µ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω—ã
    onTaskTimeout(task1)  // -1 –∂–∏–∑–Ω—å
}

// –¶–∏–∫–ª 2 (t=50ms): 
checkTimeouts() {
    // task1 –ï–©–Å –≤ activeTasks! (—É–¥–∞–ª–∏—Ç—Å—è —á–µ—Ä–µ–∑ 500ms)
    timedOutTasks = [task1, task2, task3]  // –í–°–ï –ï–©–Å –ï–°–¢–¨!
    onTaskTimeout(task1)  // -1 –∂–∏–∑–Ω—å –°–ù–û–í–ê! ‚ùå
}

// –¶–∏–∫–ª 3-10 (t=100-500ms):
// task1 –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–π —Ä–∞–∑! ‚ùå
```

**–†–µ—à–µ–Ω–∏–µ**:

1. **–§–ª–∞–≥ `isProcessingTimeout`** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
2. **–£–¥–∞–ª–µ–Ω–∏–µ –°–†–ê–ó–£** - —É–±–∏—Ä–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫—É –∏–∑ `activeTasks` –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ

```javascript
// main.js - –¥–æ–±–∞–≤–∏–ª–∏ —Ñ–ª–∞–≥
constructor() {
    this.isProcessingTimeout = false;  // ‚Üê –ù–û–í–û–ï
}

// –ë–ª–æ–∫–∏—Ä—É–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É
checkTimeouts() {
    const timedOutTasks = this.gameState.getTimedOutTasks();
    
    if (timedOutTasks.length > 0 && !this.isProcessingTimeout) {
        this.isProcessingTimeout = true;  // ‚Üê –ë–ª–æ–∫–∏—Ä—É–µ–º
        this.onTaskTimeout(timedOutTasks[0]);
    }
}

// –£–¥–∞–ª—è–µ–º –°–†–ê–ó–£, —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º —á–µ—Ä–µ–∑ 500ms
onTaskTimeout(task) {
    // ... lose life ...
    
    // –£–î–ê–õ–Ø–ï–ú –ò–ó –°–ü–ò–°–ö–ê –ù–ï–ú–ï–î–õ–ï–ù–ù–û ‚Üê –ö–õ–Æ–ß–ï–í–û–ï –ò–ó–ú–ï–ù–ï–ù–ò–ï!
    this.gameState.removeTask(task.id);
    
    setTimeout(() => {
        this.uiManager.removeTaskCard(task.id);
        this.isProcessingTimeout = false;  // ‚Üê –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º
    }, 500);
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ 1 –∫–∞—Ä—Ç–æ—á–∫–∞ –∑–∞ —Ä–∞–∑
- ‚úÖ –ö–∞—Ä—Ç–æ—á–∫–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ —Å–ø–∏—Å–∫–∞ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
- ‚úÖ –°–ª–µ–¥—É—é—â–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 500ms
- ‚úÖ –ó–∞ –∫–∞–∂–¥—É—é –∫–∞—Ä—Ç–æ—á–∫—É —Ç–µ—Ä—è–µ—Ç—Å—è —Ä–æ–≤–Ω–æ 1 –∂–∏–∑–Ω—å

---

## üìä –í—Ä–µ–º–µ–Ω–Ω–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è)

```
t=0ms:    task1 timeout ‚Üí -1 –∂–∏–∑–Ω—å ‚Üí remove from activeTasks
          isProcessingTimeout = true
          
t=50ms:   checkTimeouts() ‚Üí isProcessingTimeout=true ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
t=100ms:  checkTimeouts() ‚Üí isProcessingTimeout=true ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
...
t=500ms:  UI —É–¥–∞–ª—è–µ—Ç—Å—è ‚Üí isProcessingTimeout = false

t=550ms:  task2 timeout ‚Üí -1 –∂–∏–∑–Ω—å ‚Üí remove from activeTasks
          isProcessingTimeout = true
          
t=1050ms: UI —É–¥–∞–ª—è–µ—Ç—Å—è ‚Üí isProcessingTimeout = false

t=1100ms: task3 timeout ‚Üí -1 –∂–∏–∑–Ω—å ‚Üí Game Over!
```

---

## üß™ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Drag
1. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É
2. –ù–∞—á–Ω–∏—Ç–µ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞—Ç—å
3. –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–æ–ª–∂–Ω–∞ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –Ω–∞ –º–µ—Å—Ç–µ (—Ç–æ–ª—å–∫–æ opacity 0.3)

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ñ–∏–∑–Ω–∏
1. –ü—É—Å—Ç–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞—Ä—Ç–æ—á–µ–∫ –∏—Å—Ç–µ—á—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
2. –î–æ–∂–¥–∏—Ç–µ—Å—å timeout
3. –î–æ–ª–∂–Ω–∞ —Å–≥–æ—Ä–µ—Ç—å —Ç–æ–ª—å–∫–æ 1 –∂–∏–∑–Ω—å
4. –ß–µ—Ä–µ–∑ 500ms —Å–ª–µ–¥—É—é—â–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞
5. –ï—â–µ —á–µ—Ä–µ–∑ 500ms —Ç—Ä–µ—Ç—å—è ‚Üí Game Over

---

## üîç Debug –∫–æ–Ω—Å–æ–ª—å

–î–æ–±–∞–≤—å—Ç–µ –≤ `onTaskTimeout()` –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
```javascript
onTaskTimeout(task) {
    console.log('Timeout:', task.id, 'Lives before:', this.gameState.lives);
    
    const remainingLives = this.gameState.loseLife();
    
    console.log('Lives after:', remainingLives);
    
    // –£–¥–∞–ª—è–µ–º –°–†–ê–ó–£
    this.gameState.removeTask(task.id);
    console.log('Task removed from activeTasks');
}
```

---

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç

- [x] –£–±—Ä–∞–Ω—ã –≤—Å–µ style –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫—Ä–æ–º–µ opacity
- [x] –î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ `isProcessingTimeout`
- [x] –ö–∞—Ä—Ç–æ—á–∫–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ `activeTasks` –°–†–ê–ó–£
- [x] –§–ª–∞–≥ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 500ms
- [x] checkTimeouts –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–ª–∞–≥

---

**–¢–ï–ü–ï–†–¨ –¢–û–ß–ù–û –î–û–õ–ñ–ù–û –†–ê–ë–û–¢–ê–¢–¨!** üéØ

–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–±–µ –ø—Ä–æ–±–ª–µ–º—ã.

